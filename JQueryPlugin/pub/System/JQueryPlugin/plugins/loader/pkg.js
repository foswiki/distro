"use strict";!function(e){var t={mode:"manual",url:void 0,params:{},topic:void 0,section:void 0,skin:"text",caching:!0,select:void 0,hideEffect:"fadeOut",showEffect:"fadeIn",reloadAfter:0,delay:0,onload:function(){},finished:function(){},beforeload:function(){}};function o(o,n){var i=this;i.elem=e(o),i.opts=e.extend({},t,n),i.elem.is("pre")?i.setContent(""):i.container=i.elem.contents().wrapAll("<div class='jqLoaderContainer'></div>").parent(),i.init(),"auto"===i.opts.mode?i.loadAfter():i.opts.reloadAfter&&i.loadAfter(i.opts.reloadAfter)}o.prototype.setContent=function(t){var o=this;void 0!==o.container&&o.container.remove(),o.elem.empty(),o.container=e("<div class='jqLoaderContainer'></div>"),o.container.append(t),o.elem.is("pre")?o.container.insertAfter(o.elem):o.container.appendTo(o.elem)},o.prototype.init=function(){var t=this;t.elem.on("refresh.jqloader",(function(o,n){t.opts.params=e.extend({},t.opts.params,n),t.loadAfter(0),o.stopPropagation()})),"function"==typeof t.opts.onload&&t.elem.on("onload.jqloader",(function(e){t.opts.onload.call(t),e.stopPropagation()})),"function"==typeof t.opts.beforeload&&t.elem.on("beforeload.jqloader",(function(e){t.opts.beforeload.call(t),e.stopPropagation()})),"function"==typeof t.opts.finished&&t.elem.on("finished.jqloader",(function(e){t.opts.finished.call(t),e.stopPropagation()})),t.opts.reloadAfter&&t.elem.on("finished.jqloader",(function(e){t.loadAfter(t.opts.reloadAfter),e.stopPropagation()}))},o.prototype.loadAfter=function(e){var t=this;e=e||t.opts.delay,void 0!==t.timer&&(window.clearTimeout(t.timer),t.timer=void 0),e?t.timer=window.setTimeout((function(){t.load()}),e):t.load()},o.prototype.load=function(){var t=this,o=t.opts.web||foswiki.getPreference("WEB"),n=t.opts.topic||foswiki.getPreference("TOPIC"),i=e.extend({},t.opts.params),a=t.opts.url;void 0===a&&(a=foswiki.getScriptUrl("view",o,n)),void 0!==t.opts.section&&(i.section=t.opts.section),void 0!==t.opts.skin&&t.opts.skin&&(i.skin=t.opts.skin),t.opts.caching||(i.t=Date.now()),t.opts.hideEffect&&t.container.animateCSS({effect:t.opts.hideEffect}).one("stop.animate",(function(){t.container.hide()})),t.elem.trigger("beforeload.jqloader",t,i),e.get(a,i,"html").done((function(o){void 0!==t.opts.select&&(o=e(o).find(t.opts.select)),t.setContent(o),t.elem.trigger("onload.jqloader",t);var n=t.opts.effect||t.opts.showEffect;n&&"show"!==n&&"hide"!==n?t.container.animateCSS({effect:n}).on("stop.animate",(function(){t.elem.trigger("finished.jqloader",t)})):t.elem.trigger("finished.jqloader",t)}))},e.fn.jqLoader=function(t){return this.each((function(){e.data(this,"jqLoader")||e.data(this,"jqLoader",new o(this,t))}))},e(".jqLoader").livequery((function(){var t=e(this),o=e.extend({},t.data());t.jqLoader(o)})),e("head").append("<style>pre.jqLoader { display:none; }</style>")}(jQuery),function(e){var t={target:null,iconClass:"fa",spinClass:"fa-spin"};function o(o,n){var i=this;i.elem=e(o),i.opts=e.extend({},t,i.elem.data()),i.init()}o.prototype.init=function(){var t=this;t.icon=t.elem.find("."+t.opts.iconClass),"string"==typeof t.opts.target?t.target=e(t.opts.target):"object"==typeof t.opts.target?t.target=t.opts.target():t.target=t.elem.next(),t.target.on("beforeload.jqloader",(function(){t.icon.addClass(t.opts.spinClass)})).on("onload.jqloader",(function(){t.icon.removeClass(t.opts.spinClass)})),t.elem.on("click",(function(){return t.target.trigger("refresh"),!1}))},e.fn.jqLoaderButton=function(t){return this.each((function(){e.data(this,"jqLoaderButton")||e.data(this,"jqLoaderButton",new o(this,t))}))},e(".jqLoaderButton").livequery((function(){e(this).jqLoaderButton()}))}(jQuery);
