/*! jquery.views.js v0.9.83 (Beta): http://jsviews.com/ */
!function(e,t){var n=t.jQuery;"object"==typeof exports?module.exports=n?e(t,n):function(n){return e(t,n)}:"function"==typeof define&&define.amd?define(["jquery","./jsrender","./jquery.observable"],function(n,i,r){return e(t,n,i,r)}):e(t,!1)}(function(e,t,n,i){"use strict";function r(e,n,i){for(var r,a,l,o,s,d,f,v,c,g,u,_,h,m,x,b,k,y,C=e.target,w=C._jsvBnd;g=lt.exec(w);)if((g=Ge[g[1]])&&(x=g.to)){if(o=g.linkCtx,c=o.view,m=o.tag||c.tag,v=t(C),_=c.hlp(Ae),h=c.hlp(Se),l=p(C),r=Me[l],void 0===i&&(i=ae(l)?l(C):r?v[r]():v.attr(l)),d=x[1],x=x[0],x=x+""===x?[o.data,x]:x,d&&(s=ae(d)?d:c.getRsc("converters",d)),"SELECT"===o.elem.nodeName&&(o.elem._jsvSel=i=i||(o.elem.multiple?[]:i)),s&&(i=s.call(m,i)),u=c.linkCtx,c.linkCtx=o,b={change:"change",oldValue:o._val,value:i},!(_&&(a=_.call(o,e,b)===!1)||m&&m.onBeforeChange&&(a=m.onBeforeChange(e,b)===!1)||void 0===i)&&(f=x[0],void 0!==i&&f)){if(f._jsv)for(y=o._ctxCb,k=f,f=o.data,k._cpCtx&&(f=k.data,y=k._cpCtx);k&&k.sb;)f=y(k,f),k=k.sb;m&&(m._.chging=!0),K(f).setProperty(x[1],i),h&&h.call(o,e,b),m&&(m.onAfterChange&&m.onAfterChange(e,b),m._.chging=void 0),o._val=i}c.linkCtx=u}}function a(e,t,n){var i,r,a,o,d,f,v=this,c=v.tag,u=v.data,_=v.elem,h=v.convert,m=_.parentNode,x=v.view,b=x.linkCtx,k=x.hlp(Ae);if(x.linkCtx=v,m&&(!k||!t||k.call(v,e,t)!==!1)&&(!t||"*"===e.data.prop||e.data.prop===t.path)){if(t&&(v.eventArgs=t),t||v._toLk){if(v._toLk=0,n._er)try{r=n(u,x)}catch(y){d=n._er,f=ue(y,x,new Function("data,view","return "+d+";")(u,x)),r=[{props:{},args:[f]}]}else r=n(u,x,ne);if(i=l(r,v,c=v.tag,v.attr||p(_,!0,void 0!==h)),c){if(o=d||c._er,r=r[0]?r:[r],a=!o&&t&&c.onUpdate&&c.onUpdate(e,t,r)===!1,I(c,r,o),a||i===Le)return E(c,e,t),g(v,u,_),void(x.linkCtx=b);if(c._.chging)return;c.onUnbind&&c.onUnbind(c.tagCtx,v,c.ctx,e,t),r=":"===c.tagName?ne._cnvt(c.cvt,x,r[0]):ne._tag(c,x,x.tmpl,r,!0,f)}else n._tag&&(h=""===h?Ue:h,r=h?ne._cnvt(h,x,r[0]||r):ne._tag(n._tag,x,x.tmpl,r,!0,f),q(c=v.tag,!0),i=v.attr||i);s(r,v,i,c)&&t&&(k=x.hlp(Se))&&k.call(v,e,t),v._noUpd=0,c&&(c._er=d,E(c,e,t))}g(v,u,_),x.linkCtx=b}}function l(e,n,i,r){var a,l,o,s,d=i&&i.parentElem||n.elem;if(void 0!==e){if(s=t(d),r=i&&i.attr||r,ae(e)&&ge(n.expr+": missing parens"),o=/^css-/.test(r)&&r.slice(4))a=t.style(d,o),+e===e&&(a=parseInt(a));else if("link"!==r){if("value"===r)d.type===Te&&(a=s.prop(r=Ie));else if(r===Ve){if(d.value!==""+e)return r;a=s.prop(Ie)}void 0===a&&(l=Me[r],a=l?s[l]():s.attr(r))}n._val=a}return r}function o(e,t){e._df=t,e[(t?"set":"remove")+"Attribute"](Oe,"")}function s(n,i,r,a){var l,s,d,f,p,v,c,g,u,_,h,m,x,b,k=r!==Le&&void 0!==n&&!i._noUpd,y=i.data,C=a&&a.parentElem||i.elem,w=C.parentNode,j=t(C),E=i.view,A=i._val,S=E.linkCtx,N=a;if(a&&(a._.unlinked=!0,a.parentElem=a.parentElem||i.expr||a._elCnt?C:w,s=a._prv,d=a._nxt),k)return"visible"===r&&(r="css-display"),/^css-/.test(r)?("visible"===i.attr&&(x=(C.currentStyle||ot.call(e,C,"")).display,n?(n=C._jsvd||x,n!==Le||(n=Xe[m=C.nodeName])||(h=ee.createElement(m),ee.body.appendChild(h),n=Xe[m]=(h.currentStyle||ot.call(e,h,"")).display,ee.body.removeChild(h))):(C._jsvd=x,n=Le)),(N=N||A!==n)&&t.style(C,r.slice(4),n)):"link"!==r&&(/^data-/.test(r)&&t.data(C,r.slice(5),n),r===Ie?(v=!0,n=n&&"false"!==n):r===Ve?(v=!0,r=Ie,n=C.value===""+n):"selected"===r||"disabled"===r||"multiple"===r||"readonly"===r?n=n&&"false"!==n?r:null:"value"===r&&"SELECT"===C.nodeName&&(C._jsvSel=H(n)?n:""+n),(l=Me[r])?r===pe?(E.linkCtx=i,a&&a._.inline?(p=a.nodes(!0),a._elCnt&&(s&&s!==d?U(s,d,C,a._tgId,"^",!0):(c=C._df)&&(g=a._tgId+"^",u=c.indexOf("#"+g)+1,_=c.indexOf("/"+g),u&&_>0&&(u+=g.length,_>u&&(o(C,c.slice(0,u)+c.slice(_)),P(c.slice(u,_))))),s=s?s.previousSibling:d?d.previousSibling:C.lastChild),t(p).remove(),f=E.link(E.data,C,s,d,n,a&&{tag:a._tgId,lazyLink:a.tagCtx.props.lazyLink})):(k=k&&A!==n,k&&j.empty(),k&&(f=E.link(y,C,s,d,n,a&&{tag:a._tgId}))),E.linkCtx=S):((N=N||A!==n)&&("text"===r&&C.children&&!C.children[0]?void 0!==C.textContent?C.textContent=n:C.innerText=null===n?"":n:j[l](n)),!(b=w._jsvSel)||"value"!==r&&j.attr("value")||(C.selected=t.inArray(""+n,H(b)?b:[b])>-1)):(N=N||A!==n)&&j[v?"prop":"attr"](r,void 0!==n||v?n:null),i._val=n),f||N}function d(e,t){var n=this,i=n.hlp(Ae),r=n.hlp(Se);if(!i||i.call(this,e,t)!==!1){if(t){var a=t.change,l=t.index,o=t.items;switch(n._.srt=t.refresh,a){case"insert":n.addViews(l,o);break;case"remove":n.removeViews(l,o.length);break;case"move":n.removeViews(t.oldIndex,o.length,void 0,!0),n.addViews(l,o);break;case"refresh":n._.srt=void 0,n.fixIndex(0)}}r&&r.call(this,e,t)}}function f(e){var n,i,r=e.type,a=e.data,l=e._.bnd;!e._.useKey&&l&&((i=e._.bndArr)&&(t([i[1]]).off(fe,i[0]),e._.bndArr=void 0),l!==!!l?r?l._.arrVws[e._.id]=e:delete l._.arrVws[e._.id]:r&&a&&(n=function(t){t.data&&t.data.off||d.apply(e,arguments)},t([a]).on(fe,n),e._.bndArr=[n,a]))}function p(e,t,n){var i=e.nodeName.toLowerCase(),r=se._fe[i]||e.contentEditable===Ue&&{to:pe,from:pe};return r?t?"input"===i&&e.type===Ve?Ve:r.to:r.from:t?n?"text":pe:""}function v(e,n,i,r,a,l,o){var s,d,f,p,v,c=e.parentElem,g=e._prv,u=e._nxt,_=e._elCnt;if(g&&g.parentNode!==c&&ge("Missing parentNode"),o){p=e.nodes(),_&&g&&g!==u&&U(g,u,c,e._.id,"_",!0),e.removeViews(void 0,void 0,!0),d=u,_&&(g=g?g.previousSibling:u?u.previousSibling:c.lastChild),t(p).remove();for(v in e._.bnds)V(v)}else{if(n){if(f=r[n-1],!f)return!1;g=f._nxt}_?(d=g,g=d?d.previousSibling:c.lastChild):d=g.nextSibling}s=i.render(a,l,e._.useKey&&o,e,o||n,!0),e.link(a,c,g,d,s,f)}function c(e,t,n){var i,r;return n?(r="^`",q(n,!0),i=n._tgId,i||(Ge[i=Ye++]=n,n._tgId=""+i)):(r="_`",q(Ce[i=t._.id]=t)),"#"+i+r+(void 0!=e?e:"")+"/"+i+r}function g(e,t,n){var i,r,a,l,o,s,d,f,p=e.tag,v=e.convertBack,c=[],g=e._bndId||""+Ye++,u=e._hdl;if(e._bndId=void 0,p&&(c=p.depends||c,c=ae(c)?p.depends(p):c,l=p.linkedElem),!e._depends||""+e._depends!=""+c){if(e._depends&&K._apply(!1,[t],e._depends,u,!0),o=e.fn.deps.slice(),p&&p.boundProps)for(r=p.boundProps.length;r--;)for(d=p.boundProps[r],a=p._.bnd.paths.length;a--;)f=p._.bnd.paths[a][d],f&&f.skp&&(o=o.concat(f));for(r=o.length;r--;)s=o[r],s._jsv&&(o[r]=re({},s));if(i=K._apply(!1,[t],o,c,u,e._ctxCb),i.elem=n,i.linkCtx=e,i._tgId=g,n._jsvBnd=n._jsvBnd||"",n._jsvBnd+="&"+g,e._depends=c,e.view._.bnds[g]=g,Ge[g]=i,l)for(r=l.length;r--;)l[r]._jsvLkEl=p,N(i,p,l[r]),l[r]._jsvBnd="&"+i._tgId+"+";else void 0!==v&&N(i,p,n,v);p&&(p.flow||p._.inline||(n.setAttribute(je,(n.getAttribute(je)||"")+"#"+g+"^/"+g+"^"),p._tgId=""+g))}}function u(e,t,n,i,r,a,l){return _(this,e,t,n,i,r,a,l)}function _(e,n,i,a,l,s,d,f){if(a===!0?(l=a,a=void 0):a="object"!=typeof a?void 0:re({},a),e&&n){n=n.jquery?n:t(n),he||(he=ee.body,t(he).on(Ee,r).on("blur","[contenteditable]",r));for(var p,v,g,u,_,h,x,b,k,C=c,w=a&&"replace"===a.target,j=n.length;j--;){if(x=n[j],s=s||xe(x),(k=s===Z)&&(Z.data=(Z.ctx=a||{}).root=i),""+e===e)m(e,x,s,void 0,!0,i,a);else{if(void 0!==e.markup)w&&(h=x.parentNode),g=e.render(i,a,l,s,void 0,C),h?(d=x.previousSibling,f=x.nextSibling,t.cleanData([x],!0),h.removeChild(x),x=h):(d=f=void 0,t(x).empty());else{if(e!==!0||s!==Z)break;b={lnk:1}}if(x._df&&!f){for(u=y(x._df,!0,tt),p=0,v=u.length;p<v;p++)_=u[p],(_=Ce[_.id])&&void 0!==_.data&&_.parent.removeViews(_._.key,void 0,!0);o(x)}s.link(i,x,d,f,g,b,a)}k&&(Z.data=Z.ctx=void 0)}}return n}function h(e,n,i,r,a,l,s,p){function v(e,t,n,i,r,l,o,s,d,f,p,v,c,g){var u,_,m="";return g?(h=0,e):(j=d||f||"",i=i||p,n=n||c,Y&&!n&&(!e||i||j||l&&!h)&&(Y=void 0,G=Ae.shift()),i=i||n,i&&(h=0,Y=void 0,K&&(n||c?We[G]||/;svg;|;math;/.test(";"+Ae.join(";")+";")||(u="'<"+G+".../"):We[i]?u="'</"+i:Ae.length&&i===G||(u="Mismatch: '</"+i),u&&ve(u+">' in:\n"+a)),re=ie,G=Ae.shift(),ie=Je[G],p=p?"</"+p+">":"",re&&(we+=le,le="",ie?we+="-":(m=p+qe+"@"+we+Pe+(v||""),we=Se.shift()))),ie?(l?le+=l:t=p||c||"",j&&(t+=j,le&&(t+=" "+je+'="'+le+'"',le=""))):t=l?t+m+r+(h?"":qe+l+Pe)+s+j:m||e,K&&o&&(h&&ve("{^{ within elem markup ("+h+' ). Use data-link="..."'),"#"===l.charAt(0)?Ae.unshift(l.slice(1)):l.slice(1)!==(_=Ae.shift())&&ve("Closing tag for {^{...}} under different elem: <"+_+">")),j&&(h=j,Ae.unshift(G),G=j.slice(1),K&&Ae[0]&&Ae[0]===Qe[G]&&ge("Parent of <tr> must be <tbody>"),Y=We[G],(ie=Je[G])&&!re&&(Se.unshift(we),we=""),re=ie,we&&ie&&(we+="+")),t)}function g(e,t){var i,r,a,l,s,p,v,g=[];if(e){for("@"===e._tkns.charAt(0)&&(t=V.previousSibling,V.parentNode.removeChild(V),V=void 0),I=e.length;I--;){if(B=e[I],a=B.ch,i=B.path)for(N=i.length-1;r=i.charAt(N--);)"+"===r?"-"===i.charAt(N)?(N--,t=t.previousSibling):t=t.parentNode:t=t.lastChild;"^"===a?(j=Ge[s=B.id])&&(v=t&&(!V||V.parentNode!==t),V&&!v||(j.parentElem=t),B.elCnt&&v&&o(t,(B.open?"#":"/")+s+a+(t._df||"")),g.push([v?null:V,B])):(L=Ce[s=B.id])&&(L.parentElem||(L.parentElem=t||V&&V.parentNode||n,L._.onRender=c,L._.onArrayChange=d,f(L)),l=L.parentElem,B.open?(L._elCnt=B.elCnt,t&&!V?o(t,"#"+s+a+(t._df||"")):(L._prv||o(l,b(l._df,"#"+s+a)),L._prv=V)):(!t||V&&V.parentNode===t?V&&(L._nxt||o(l,b(l._df,"/"+s+a)),L._nxt=V):(o(t,"/"+s+a+(t._df||"")),L._nxt=void 0),(p=L.ctx&&L.ctx[Ne]||Ie)&&p.call(L.ctx.tag,L)))}for(I=g.length;I--;)Ee.push(g[I])}return!e||e.elCnt}function u(e){var t,n,i;if(e)for(I=e.length,N=0;N<I;N++)if(B=e[N],n=j=Ge[B.id].linkCtx.tag,i=j.tagName===R,!j.flow||i){if(!F){for(t=1;n=n.parent;)t++;H=H||t}!F&&t!==H||R&&!i||$.push(j)}}function _(){var l,o,d="",f={},p=ke+(_e?",["+Oe+"]":"");for(T=He?n.querySelectorAll(p):t(p,n).get(),S=T.length,i&&i.innerHTML&&(P=He?i.querySelectorAll(p):t(p,i).get(),i=P.length?P[P.length-1]:i),H=0,A=0;A<S;A++)if(V=T[A],i&&!de)de=V===i;else{if(r&&V===r){_e&&(d+=k(V));break}if(V.parentNode)if(_e){if(d+=k(V),V._df){for(l=A+1;l<S&&V.contains(T[l]);)l++;f[l-1]=V._df}f[A]&&(d+=f[A]||"")}else ue&&(B=y(V,void 0,it))&&(B=B[0])&&(fe=fe?B.id!==fe&&fe:B.open&&B.id),!fe&&Te(y(V))&&V.getAttribute(be)&&Ee.push([V])}if(_e&&(d+=n._df||"",(o=d.indexOf("#"+_e.id)+1)&&(d=d.slice(o+_e.id.length)),o=d.indexOf("/"+_e.id),o+1&&(d=d.slice(0,o)),u(y(d,void 0,rt))),void 0===a&&n.getAttribute(be)&&Ee.push([n]),C(i,ie),C(r,ie),_e)return void(pe&&pe.resolve());for(ie&&we+le&&(V=r,we&&(r?g(y(we+"+",!0),r):g(y(we,!0),n)),g(y(le,!0),n),r&&(d=r.getAttribute(je),(S=d.indexOf(oe)+1)&&(d=d.slice(S+oe.length-1)),r.setAttribute(je,le+d))),S=Ee.length,A=0;A<S;A++)V=Ee[A],U=V[1],V=V[0],U?(j=Ge[U.id])&&((x=j.linkCtx)&&(j=x.tag,j.linkCtx=x),U.open?(V&&(j.parentElem=V.parentNode,j._prv=V),j._elCnt=U.elCnt,L=j.tagCtx.view,m(void 0,j._prv,L,U.id)):(j._nxt=V,j._.unlinked&&(z=j.tagCtx,L=z.view,E(j)))):m(V.getAttribute(be),V,xe(V),void 0,ue,e,s);pe&&pe.resolve()}var h,x,j,A,S,N,I,T,V,L,B,U,P,q,O,D,M,$,F,R,z,K,H,J,Q,W,X,G,Y,Z,te,ne,ie,re,ae,le,oe,de,fe,pe,ue,_e,he=this,me=he._.id+"_",we="",Ee=[],Ae=[],Se=[],Ie=he.hlp(Ne),Te=g;if(l&&(pe=l.lazyLink&&t.Deferred(),l.tmpl?O="/"+l._.id+"_":(ue=l.lnk,l.tag&&(me=l.tag+"^",l=!0),(_e=l.get)&&(Te=u,$=_e.tags,F=_e.deep,R=_e.name)),l=l===!0),n=n?""+n===n?t(n)[0]:n.jquery?n[0]:n:he.parentElem||ee.body,K=!se.noValidate&&n.contentEditable!==Ue,G=n.tagName.toLowerCase(),ie=!!Je[G],i=i&&w(i,ie),r=r&&w(r,ie)||null,void 0!=a){if(te=ee.createElement("div"),Z=te,oe=le="",ae="http://www.w3.org/2000/svg"===n.namespaceURI?"svg_ns":(X=ce.exec(a))&&X[1]||"",ie){for(M=r;M&&!(D=y(M));)M=M.nextSibling;(ne=D?D._tkns:n._df)&&(q=O||"",!l&&O||(q+="#"+me),N=ne.indexOf(q),N+1&&(N+=q.length,oe=le=ne.slice(0,N),ne=ne.slice(N),D?M.setAttribute(je,ne):o(n,ne)))}if(Y=void 0,a=(""+a).replace(et,v),K&&Ae.length&&ve("Mismatched '<"+G+"...>' in:\n"+a),p)return;for(Ke.appendChild(te),ae=ye[ae]||ye.div,J=ae[0],Z.innerHTML=ae[1]+a+ae[2];J--;)Z=Z.lastChild;for(Ke.removeChild(te),Q=ee.createDocumentFragment();W=Z.firstChild;)Q.appendChild(W);n.insertBefore(Q,r)}return pe?setTimeout(_,0):_(),pe&&pe.promise()}function m(e,t,n,i,r,a,l){var o,s,d,f,v,c,g,u,_,h,m,b=[];if(i)u=Ge[i],u=u.linkCtx?u.linkCtx.tag:u,g=u.linkCtx||{type:"inline",data:n.data,elem:u._elCnt?u.parentElem:t,view:n,ctx:n.ctx,attr:pe,fn:u._.bnd,tag:u,_bndId:i},x(g,g.fn);else if(e&&t){for(a=r?a:n.data,o=n.tmpl,e=j(e,p(t)),m=me.lastIndex=0;s=me.exec(e);)b.push(s),m=me.lastIndex;for(m<e.length&&ve(e);s=b.shift();){for(_=me.lastIndex,d=s[1],v=s[3];b[0]&&"else"===b[0][4];)v+=G+Q+b.shift()[3],h=!0;h&&(v+=G+Q+W+"/"+s[4]+X),g={type:r?"top":"link",data:a,elem:t,view:n,ctx:l,attr:d,isLk:r,_toLk:1,_noUpd:s[2]},f=void 0,s[6]&&(f=s[10]||void 0,g.convert=s[5]||"",!d&&void 0!==f&&p(t)&&(g.convertBack=f=f.slice(1))),g.expr=d+v,c=o.links[v],c||(o.links[v]=c=ne.tmplFn(v,o,!0,f,h)),g.fn=c,x(g,c),me.lastIndex=_}}}function x(e,t){function n(n,i){a.call(e,n,i,t)}n.noArray=!0,e.isLk&&q(e.view=new ne.View(ne.extendCtx(e.ctx,e.view.ctx),"link",e.view,e.data,e.expr,(void 0),c)),e._ctxCb=ne._gccb(e.view),e._hdl=n,n(!0)}function b(e,t){var n;return e?(n=e.indexOf(t),n+1?e.slice(0,n)+e.slice(n+t.length):e):""}function k(e){return e&&(""+e===e?e:e.tagName===Be?e.type.slice(3):1===e.nodeType&&e.getAttribute(je)||"")}function y(e,t,n){function i(e,t,n,i,a,o){l.push({elCnt:r,id:i,ch:a,open:t,close:n,path:o,token:e})}var r,a,l=[];if(a=t?e:k(e))return r=l.elCnt=e.tagName!==Be,r="@"===a.charAt(0)||r,l._tkns=a,a.replace(n||at,i),l}function C(e,t){e&&("jsv"===e.type?e.parentNode.removeChild(e):t&&""===e.getAttribute(be)&&e.removeAttribute(be))}function w(e,t){for(var n=e;t&&n&&1!==n.nodeType;)n=n.previousSibling;return n&&(1!==n.nodeType?(n=ee.createElement(Be),n.type="jsv",e.parentNode.insertBefore(n,e)):k(n)||n.getAttribute(be)||n.setAttribute(be,"")),n}function j(e,n){return e=t.trim(e).replace(_e,"\\$&"),e.slice(-1)!==X?e=W+":"+e+(n?":":"")+X:e}function E(e,n,i){var r,a,l,o,s,d,f=e.tagCtx,p=(f.view,f.props),v=e.linkCtx;if(e._.unlinked&&(void 0!==e.linkedElement&&(e.linkedElem=e._.inline?e.contents(!0,e.linkedElement||"*").first():t(v.elem)),e.onBind&&e.onBind(f,v,e.ctx,n,i)),e.onAfterLink&&e.onAfterLink(f,v,e.ctx,n,i),r=e.targetTag?e.targetTag.linkedElem:e.linkedElem,a=e.displayElem||r,r&&r[0]){if(o=e.cvtArgs()[0],void 0!==o&&!e._.chging)for(s=r.length;s--;)l=r[s],e._.unlinked&&l!==v.elem&&(d=l._jsvLkEl,e._.inline&&(!d||d!==e&&d.targetTag!==e)&&(l._jsvLkEl=e,N(Ge[e._tgId],e,l),l._jsvBnd="&"+e._tgId+"+")),void 0!==o&&(void 0!==l.value?l.type===Te?l[Ie]=o&&"false"!==o:l.type===Ve?l[Ie]=l.value===o:t(l).val(o):l.contentEditable===Ue&&(l.innerHTML=o),v._val=o),p.name&&(l.name=l.name||p.name);e.setSize&&(p.height&&a.height(p.height),p.width&&a.width(p.width)),void 0!==p.title&&a.attr("title",p.title),p["class"]&&(i&&a.hasClass(i.oldValue)&&a.removeClass(i.oldValue),a.addClass(p["class"])),p.id&&(r[0].id=p.id)}e._.unlinked=void 0}function A(e){setTimeout(function(){r(e)},0)}function S(e,t,n){t&&(t=""+t===t?t:"keydown",e[n](t,"keydown"===t?A:r))}function N(e,n,i,r){var a,l,o,s,d,f,p,v,c,g,u=e.linkCtx,_=u._ctxCb,h=u.data,m=u.fn.paths[0];if(n=n||i._jsvLkEl,e&&m&&!e.to){if(v=i._jsvTr||!1,n&&(r=n.convertBack||r,p=n.tagCtx.props.trigger),p=void 0===p?ie.trigger:p,p=p&&("INPUT"===i.tagName&&i.type!==Te&&i.type!==Ve||"textarea"===i.type||i.contentEditable===Ue)&&p||!1,v!==p&&(f=t(i),S(f,v,"off"),S(f,i._jsvTr=p,"on")),m=(a=m._jsvto)||m[0],l=m&&m.length){if(s=m[l-1],s._jsv){for(d=s;s.sb&&s.sb._jsv;)o=s=s.sb;o=s.sb||o&&o.path,s=o?o.slice(1):d.path}if(o)c=[d,s];else{for(;(c=_(o=s.split("^").join("."),h))&&(g=c.length);){if(c[0]._cp){if(c=c[0],_=ne._gccb(c[0]),s=c[1],c=[c[0].data,c[1]],s._jsv){for(d=s,d.data=c[0],d._cpCtx=_;s.sb&&s.sb._jsv;)o=s=s.sb;o=s.sb||o&&o.path,s=o?o.slice(1):d.path,c=[d,s]}}else c=g>2?[c[g-3],c[g-2]]:[c[g-2]];h=c[0],s=c[1]}c=c||[h,o]}}else c=[];e.to=[c,r]}}function I(e,t,n){var i,r,a=e.tagCtx.view,l=e.tagCtxs||[e.tagCtx],o=l.length,s=!t;if(t=t||e._.bnd.call(a.tmpl,(e.linkCtx||a).data,a,ne),n)l=e.tagCtxs=t,e.tagCtx=l[0];else for(;o--;)i=l[o],r=t[o],K(i.props).setProperty(r.props),re(i.ctx,r.ctx),i.args=r.args,s&&(i.tmpl=r.tmpl);return ne._ths(e,l[0]),l}function T(e){for(var t,n,i,r=[],a=e.length,l=a;l--;)r.push(e[l]);for(l=a;l--;)if(n=r[l],n.parentNode){if(i=n._jsvBnd)for(i=i.slice(1).split("&"),n._jsvBnd="",t=i.length;t--;)V(i[t],n._jsvLkEl,n);P(k(n)+(n._df||""))}}function V(e,n,i){var r,a,l,o,s,d,f,p,v,c,g,u,_=Ge[e];if(n)n=n.targetTag||n,i._jsvLkEl=void 0;else if(_){delete Ge[e];for(r in _.bnd)o=_.bnd[r],s=_.cbId,H(o)?t([o]).off(fe+s).off(de+s):t(o).off(de+s),delete _.bnd[r];if(a=_.linkCtx){if(l=a.tag){if(d=l.tagCtxs)for(f=d.length;f--;)(p=d[f].map)&&p.unmap();v=l.linkedElem,l.onUnbind&&l.onUnbind(l.tagCtx,a,l.ctx,!0),l.onDispose&&l.onDispose(),l._elCnt||(l._prv&&l._prv.parentNode.removeChild(l._prv),l._nxt&&l._nxt.parentNode.removeChild(l._nxt))}c=v&&v[0]||a.elem,(g=c&&c._jsvTr)&&(S(v||t(c),g,"off"),c._jsvTr=void 0),u=a.view,"link"===u.type?u.parent.removeViews(u._.key,void 0,!0):delete u._.bnds[e]}delete _.s[_.cbId]}}function L(e){e?(e=e.jquery?e:t(e),e.each(function(){for(var e;(e=xe(this,!0))&&e.parent;)e.parent.removeViews(e._.key,void 0,!0);T(this.getElementsByTagName("*"))}),T(e)):(he&&(t(he).off(Ee,r).off("blur","[contenteditable]",r),he=void 0),Z.removeViews(),T(ee.body.getElementsByTagName("*")))}function B(e){return e.type===Te?e[Ie]:e.value}function U(e,t,n,i,r,a){var l,s,d,f,p,v,c,g=0,u=e===t;if(e){for(d=y(e)||[],l=0,s=d.length;l<s;l++){if(f=d[l],v=f.id,v===i&&f.ch===r){if(!a)break;s=0}u||(p="_"===f.ch?Ce[v]:Ge[v].linkCtx.tag,f.open?p._prv=t:f.close&&(p._nxt=t)),g+=v.length+2}g&&e.setAttribute(je,e.getAttribute(je).slice(g)),c=t?t.getAttribute(je):n._df,(s=c.indexOf("/"+i+r)+1)&&(c=d._tkns.slice(0,g)+c.slice(s+(a?-1:i.length+1))),c&&(t?t.setAttribute(je,c):o(n,c))}else o(n,b(n._df,"#"+i+r)),a||t||o(n,b(n._df,"/"+i+r))}function P(e){var t,n,i,r;if(r=y(e,!0,nt))for(t=0,n=r.length;t<n;t++)i=r[t],"_"===i.ch?(i=Ce[i.id])&&i.type&&i.parent.removeViews(i._.key,void 0,!0):V(i.id)}function q(e,n){e.contents=function(e,n){e!==!!e&&(n=e,e=void 0);var i,r=t(this.nodes());return r[0]&&(i=n?r.filter(n):r,r=e&&n?i.add(r.find(n)):i),r},e.nodes=function(e,t,n){var i,r=this,a=r._elCnt,l=!t&&a,o=[];for(t=t||r._prv,n=n||r._nxt,i=l?t===r._nxt?r.parentElem.lastSibling:t:r._.inline===!1?t||r.linkCtx.elem.firstChild:t&&t.nextSibling;i&&(!n||i!==n);)(e||a||i.tagName!==Be)&&o.push(i),i=i.nextSibling;return o},e.childTags=function(e,t){e!==!!e&&(t=e,e=void 0);var n=this,i=n.link?n:n.tagCtx.view,r=n._prv,a=n._elCnt,l=[];return i.link(void 0,n.parentElem,a?r&&r.previousSibling:r,n._nxt,void 0,{get:{tags:l,deep:e,name:t,id:n.link?n._.id+"_":n._tgId+"^"}}),l},e.refresh=function(e){var t,n,i=this,r=i.linkCtx,a=i.tagCtx.view;return i.disposed&&ge("Removed tag"),void 0===e&&(e=ne._tag(i,a,a.tmpl,I(i),!0)),e+""===e&&(i.onUnbind&&i.onUnbind(i.tagCtx,r,i.ctx),n=i._.inline?pe:r.attr||p(i.parentElem,!0),t=s(e,r,n,i)),E(i),t||i},e.update=function(e){var t=this.linkedElem;t&&r({target:t[0]},void 0,e)},n?e.domChange=function(){var e=this.parentElem,n=t.hasData(e)&&t._data(e).events,i="jsv-domchange";n&&n[i]&&t(e).triggerHandler(i,arguments)}:(e.addViews=function(e,t){var n,i=this,r=t.length,a=i.views;!i._.useKey&&r&&(n=a.length+r,n===i.data.length&&v(i,e,i.tmpl,a,t,i.ctx)!==!1&&(i._.srt||i.fixIndex(e+r)))},e.removeViews=function(e,n,i,r){function a(e){var n,r,a,l,o,s,d=v[e];if(d&&d.link){if(n=d._.id,i||(s=d.nodes()),d.removeViews(void 0,void 0,!0),d.type=void 0,l=d._prv,o=d._nxt,a=d.parentElem,i||(d._elCnt&&U(l,o,a,n,"_"),t(s).remove()),!d._elCnt)try{l.parentNode.removeChild(l),o.parentNode.removeChild(o)}catch(p){}f(d);for(r in d._.bnds)V(r);delete Ce[n]}}var l,o,s,d=this,p=!d._.useKey,v=d.views;if(p&&(s=v.length),void 0===e)if(p){for(l=s;l--;)a(l);d.views=[]}else{for(o in v)a(o);d.views={}}else if(void 0===n&&(p?n=1:(a(e),delete v[e])),p&&n&&(r||s-n===d.data.length)){for(l=e+n;l-- >e;)a(l);v.splice(e,n),d._.sort||d.fixIndex(e)}},e.refresh=function(){var e=this,t=e.parent;t&&(v(e,e.index,e.tmpl,t.views,e.data,void 0,!0),f(e))},e.fixIndex=function(e){for(var t=this.views,n=t.length;e<n--;)t[n].index!==n&&K(t[n]).setProperty("index",n)},e.link=h)}function O(e){return this.tagCtx.view}function D(e,t,n){if("set"===n.change){for(var i=e.tgt,r=i.length;r--&&i[r].key!==n.path;);r===-1?n.path&&!n.remove&&K(i).insert({key:n.path,prop:n.value}):n.remove?K(i).remove(r):K(i[r]).setProperty("prop",n.value)}}function M(e,t,n){var i,r=e.src,a=n.change;"set"===a?"prop"===n.path?K(r).setProperty(t.target.key,n.value):(K(r).removeProperty(n.oldValue),K(r).setProperty(n.value,t.target.prop)):"remove"===a?(i=n.items[0],K(r).removeProperty(i.key),delete r[i.key]):"insert"===a&&(i=n.items[0],i.key&&K(r).setProperty(i.key,i.prop))}function $(e){return e.indexOf(".")<0}var F=t===!1;n=n||F&&e.jsrender,t=t||e.jQuery;var R="JsViews requires ";if(!t||!t.fn)throw R+"jQuery";n&&!n.fn&&n.views.sub._jq(t);var z,K,H=t.isArray,J=t.views;if(!J||!J.map)throw R+"JsRender";var Q,W,X,G,Y,Z,ee=e.document,te=J.settings,ne=J.sub,ie=ne.settings,re=ne.extend,ae=t.isFunction,le=(t.expando,J.converters),oe=J.tags,se=ie.advanced,de=ne.propChng=ne.propChng||"propertyChange",fe=ne.arrChng=ne.arrChng||"arrayChange",pe="html",ve=ne.syntaxErr,ce=/<(?!script)(\w+)[>\s]/,ge=ne._er,ue=ne._err,_e=/['"\\]/g;if(t.link)return t;ie.trigger=!0;var he,me,xe,be,ke,ye,Ce,we,je="data-jsv",Ee="change.jsv",Ae="onBeforeChange",Se="onAfterChange",Ne="onAfterCreate",Ie="checked",Te="checkbox",Ve="radio",Le="none",Be="SCRIPT",Ue="true",Pe='"></script>',qe='<script type="jsv',Oe=je+"-df",De="script,["+je+"]",Me={value:"val",input:"val",html:pe,text:"text"},$e={from:"value",to:"value"},Fe=0,Re=t.cleanData,ze=te.delimiters,Ke=ee.createDocumentFragment(),He=ee.querySelector,Je={ol:1,ul:1,table:1,tbody:1,thead:1,tfoot:1,tr:1,colgroup:1,dl:1,select:1,optgroup:1,svg:1,svg_ns:1},Qe={tr:"table"},We={br:1,img:1,input:1,hr:1,area:1,base:1,col:1,link:1,meta:1,command:1,embed:1,keygen:1,param:1,source:1,track:1,wbr:1},Xe={},Ge={},Ye=1,Ze=/^#(view\.?)?/,et=/((\/>)|<\/(\w+)>|)(\s*)([#\/]\d+(?:_|(\^)))`(\s*)(<\w+(?=[\s\/>]))?|\s*(?:(<\w+(?=[\s\/>]))|<\/(\w+)>(\s*)|(\/>)\s*|(>)|$)/g,tt=/(#)()(\d+)(_)/g,nt=/(#)()(\d+)([_^])/g,it=/(?:(#)|(\/))(\d+)(_)/g,rt=/(#)()(\d+)(\^)/g,at=/(?:(#)|(\/))(\d+)([_^])([-+@\d]+)?/g,lt=/&(\d+)\+?/g,ot=e.getComputedStyle;if(K=t.observable,!K)throw R+"JsObservable";return z=K.observe,ne.onStore.template=function(e,n){n.link=u,e&&(t.link[e]=function(){return u.apply(n,arguments)})},ne.viewInfos=y,(te.delimiters=function(){var e=ze.apply(0,arguments),t=ie.delimiters;return Q=t[0].charAt(0),W=t[0].charAt(1),X=t[1].charAt(0),G=t[1].charAt(1),Y=t[2],me=new RegExp("(?:^|\\s*)([\\w-]*)(\\"+Y+")?(\\"+W+ne.rTag+"(:\\w*)?\\"+X+")","g"),e})(),ne.addSetting("trigger"),le.merge=function(e){var t,n=this.linkCtx._val||"",i=this.tagCtx.props.toggle;return i&&(t=i.replace(/[\\^$.|?*+()[{]/g,"\\$&"),t="(\\s(?="+t+"$)|(\\s)|^)("+t+"(\\s|$))",n=n.replace(new RegExp(t),"$2"),e=n+(e?(n&&" ")+i:"")),e},oe({on:{attr:Le,init:function(e){for(var n,i=this,r=0,a=e.args,l=a.length;r<l&&!ae(a[r]);r++);i._hi=l>r&&r+1,i._.inline&&(ne.rTmpl.exec(n=e.tmpl.markup)||(i.template="<button>"+(t.trim(n)||e.params.args[r]||"noop")+"</button>"),i.attr=pe)},onAfterLink:function(e,n){var i,r,a,l=this,o=l._hi,s=e.args,d=s.length,f=e.props,p=f.data,v=e.view,c=f.context;o&&(i=s[o-1],r=s.slice(o),s=s.slice(0,o-1),l._sel=s[1],a=l.activeElem=l.activeElem||t(l._.inline?(l._sel=s[1]||"*",l.parentElem):n.elem),c||(c=/^(.*)[\.^][\w$]+$/.exec(e.params.args.slice(-r.length-1)[0]),c=c&&ne.tmplFn(W+":"+c[1]+X,v.tmpl,!0)(n.data,v)),l._evs&&l.onUnbind(),a.on(l._evs=s[0]||"click",l._sel,void 0==p?null:p,l._hlr=function(e){var t,a=!l._.inline;if(!a)for(t=l.contents("*"),d=t.length;!a&&d--;)t[d].contains(e.target)&&(a=!0);if(a)return i.apply(c||n.data,[].concat(r,e,{change:e.type,view:v,linkCtx:n},r.slice.call(arguments,1)))}))},onUpdate:function(){return!1},onUnbind:function(){var e=this;e.activeElem&&e.activeElem.off(e._evs,e._sel,e._hlr)},flow:!0,contentCtx:O,dataBoundOnly:!0},radiogroup:{init:function(e){this.name=e.props.name||"jsv"+Math.random()},onBind:function(e,n){var i,r=this,a=r.linkedElem=r._.inline?r.contents(!0,"input[type=radio]"):t(n.elem).find("input[type=radio]"),l=a.length;for(r._.inline?(i=r.contents("*")[0],i=i&&t.view(i).ctx.tag===r.parent?i:r.parentElem):i=n.elem;l--;)a[l].name=a[l].name||r.name;t(i).on("jsv-domchange",function(e,t){var n,o=t.ctx.parentTags;if(!r._.inline||i!==r.parentElem||o&&o[r.tagName]===r)for(a=r.linkedElem=r.contents(!0,"input[type=radio]"),l=a.length;l--;)n=a[l],n._jsvLkEl=r,n.name=n.name||r.name,N(Ge[r._tgId],r,n),n._jsvBnd="&"+r._tgId+"+",n.checked=r.cvtArgs()[0]===n.value})},onUpdate:function(e,t,n){return!1},contentCtx:O,dataBoundOnly:!0}}),re(oe["for"],{onArrayChange:function(e,t,n,i){var r,a=e.target,l=a.length,o=this,s=t.change;if(o._.noVws||o.tagCtxs[1]&&("insert"===s&&l===t.items.length||"remove"===s&&!l))o.refresh();else for(r in o._.arrVws)r=o._.arrVws[r],r.data===a&&r._.onArrayChange.apply(r,arguments);o.domChange(n,i,t),e.done=!0},onAfterLink:function(e,t){var n,i,r,a,l=this,o=l._ars||{},s=l.tagCtxs,d=s.length,f=l.selected||0;for(n=0;n<=f;n++)e=s[n],a=e.map?e.map.tgt:e.args.length?e.args[0]:e.view.data,(r=o[n])&&a!==r[0]&&(z(r[0],r[1],!0),delete o[n]),!o[n]&&H(a)&&(z(a,i=function(n,i){var r=e;l.onArrayChange(n,i,r,t)}),o[n]=[a,i]);for(n=f+1;n<d;n++)(r=o[n])&&(z(r[0],r[1],!0),delete o[n]);l._ars=o},onDispose:function(){var e,t=this;for(e in t._ars)z(t._ars[e][0],t._ars[e][1],!0)}}),re(oe["if"],{onUpdate:function(e,t,n){var i,r,a;for(i=0;r=this.tagCtxs[i];i++)if(a=r.props.tmpl!==n[i].props.tmpl||r.args.length&&!(r=r.args[0])!=!n[i].args[0],!this.convert&&r||a)return a;return!1},onAfterLink:function(e,t,n,i,r){r&&this.domChange(e,t,r)}}),oe("props",{baseTag:"for",dataMap:J.map({getTgt:oe.props.dataMap.getTgt,obsSrc:D,obsTgt:M,tgtFlt:$}),flow:!0}),re(t,{view:xe=function(e,n,i){function r(e,t){if(e)for(l=y(e,t,tt),s=0,d=l.length;s<d&&(!(a=Ce[l[s].id])||!(a=a&&i?a.get(!0,i):a));s++);}n!==!!n&&(i=n,n=void 0);var a,l,o,s,d,f,p,v=0,c=ee.body;if(e&&e!==c&&Z._.useKey>1&&(e=""+e===e?t(e)[0]:e.jquery?e[0]:e)){if(n){if(r(e._df,!0),!a)for(p=He?e.querySelectorAll(De):t(De,e).get(),f=p.length,o=0;!a&&o<f;o++)r(p[o]);return a}for(;e;){if(l=y(e,void 0,it))for(f=l.length;f--;)if(a=l[f],a.open){if(v<1)return a=Ce[a.id],a&&i?a.get(i):a||Z;v--}else v++;e=e.previousSibling||e.parentNode}}return Z},link:_,unlink:L,cleanData:function(e){e.length&&Fe&&T(e),Re.apply(t,arguments)}}),re(t.fn,{link:function(e,t,n,i,r,a,l){return _(e,this,t,n,i,r,a,l)},unlink:function(){return L(this)},view:function(e,t){return xe(this[0],e,t)}}),t.each([pe,"replaceWith","empty","remove"],function(e,n){var i=t.fn[n];t.fn[n]=function(){var e;Fe=1;try{e=i.apply(this,arguments)}finally{Fe=0}return e}}),q(re(Z=ne.topView,{tmpl:{links:{}}})),Ce={0:Z},J.getCtx=function(e){return e&&e._cp&&(e=e[1](e[0].data,e[0],ne)),e},ne._cp=function(e,t,n){if(n.linked){t=W+":"+t+X;var i=n.tmpl,r=Z.tmpl.links,a=r[t];a||(r[t]=a=ne.tmplFn(t,i,!0)),e=[n,a],e._cp=!0}return e},ne._ceo=function st(e){var t,n=e,i=e.length;if(i)for(n=[];i--;)t=e[i],t._jsv&&(t=re({},t),t.prm=st(t.prm)),n.unshift(t);return n},ne._gccb=function(e){return function(t,n,i){var r,a,l,o,s,d,f;if(e&&t){if(t._jsv)return t._jsv.call(e.tmpl,n,e,ne);if("~"===t.charAt(0))return"~tag"===t.slice(0,4)&&(a=e.ctx,"."===t.charAt(4)&&(r=t.slice(5).split("."),a=a.tag),r)?a?[a,r.join("."),n]:[]:(t=t.slice(1).split("."),(o=e.hlp(s=t.shift(),!0))&&(o._cp?(t.length&&(d="."+t.join("."),s=o[f=o.length-1],s._jsv?(s.sb=d,s.bnd=!!i):(o[f]=(s+d).replace("#data.",""),"#view"===s.slice(0,5)&&(o[f]=o[f].slice(6),o.splice(f,0,e)))),l=[o]):(t.length||ae(o))&&(l=[o,t.join("."),n])),l||[]);if("#"===t.charAt(0))return"#data"===t?[]:[e,t.replace(Ze,""),n]}}},we=ne.advSet,ne.advSet=function(){we.call(ne),e._jsv=se._jsv?re(e._jsv||{},{views:Ce,bindings:Ge}):void 0,be=se.linkAttr,ke=De+",["+be+"]",ye=se._wm,ye.optgroup=ye.option,ye.tbody=ye.tfoot=ye.colgroup=ye.caption=ye.thead,ye.th=ye.td},te.advanced({linkAttr:"data-link",useViews:!1,noValidate:!1,_wm:{option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],svg_ns:[1,"<svg>","</svg>"],div:t.support.htmlSerialize?[0,"",""]:[1,"X<div>","</div>"]},_fe:{input:{from:B,to:"value"},textarea:$e,select:$e,optgroup:{to:"label"}}}),t},window);
//# sourceMappingURL=jquery.views.min.js.map
